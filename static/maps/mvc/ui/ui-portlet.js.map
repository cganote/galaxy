{"version":3,"sources":["mvc/ui/ui-portlet.js"],"names":["View","Backbone","extend","visible","initialize","options","self","model","Model","id","Utils","uid","cls","title","icon","buttons","body","scrollable","nopadding","operations","collapsible","collapsible_button","collapsed","onchange_title","set","setElement","_template","$body","$","$title","$title_text","$title_icon","$header","$content","$backdrop","$buttons","$operations","get","append","Ui","ButtonIcon","tooltip","onclick","render","attributes","$el","removeClass","addClass","attr","html","title_id","_","each","show","hide","off","on","collapse","expand","prop","make_text_editable","on_finish","new_title","empty","name","item","header","fadeIn","enableButton","find","disableButton","hideOperation","showOperation","setOperation","callback","height","setIcon","disable","enable"],"mappings":"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","file":"../../../scripts/mvc/ui/ui-portlet.js","sourcesContent":["import Utils from \"utils/utils\";\nimport Ui from \"mvc/ui/ui-misc\";\n\nexport var View = Backbone.View.extend({\n    visible: false,\n    initialize: function(options) {\n        var self = this;\n        this.model =\n            (options && options.model) ||\n            new Backbone.Model({\n                id: Utils.uid(),\n                cls: \"ui-portlet\",\n                title: \"\",\n                icon: \"\",\n                buttons: null,\n                body: null,\n                scrollable: true,\n                nopadding: false,\n                operations: null,\n                collapsible: false,\n                collapsible_button: false,\n                collapsed: false,\n                onchange_title: null\n            }).set(options);\n        this.setElement(this._template());\n\n        // link all dom elements\n        this.$body = this.$(\".portlet-body\");\n        this.$title = this.$(\".portlet-title\");\n        this.$title_text = this.$(\".portlet-title-text\");\n        this.$title_icon = this.$(\".portlet-title-icon\");\n        this.$header = this.$(\".portlet-header\");\n        this.$content = this.$(\".portlet-content\");\n        this.$backdrop = this.$(\".portlet-backdrop\");\n        this.$buttons = this.$(\".portlet-buttons\");\n        this.$operations = this.$(\".portlet-operations\");\n\n        // add body to component list\n        this.model.get(\"body\") && this.append(this.model.get(\"body\"));\n\n        // add icon for collapsible option\n        this.collapsible_button = new Ui.ButtonIcon({\n            icon: \"fa-eye\",\n            tooltip: \"Collapse/Expand\",\n            cls: \"ui-button-icon-plain\",\n            onclick: function() {\n                self[self.collapsed ? \"expand\" : \"collapse\"]();\n            }\n        });\n        this.render();\n    },\n\n    render: function() {\n        var self = this;\n        var options = this.model.attributes;\n        this.$el\n            .removeClass()\n            .addClass(options.cls)\n            .attr(\"id\", options.id);\n        this.$header[options.title ? \"show\" : \"hide\"]();\n        this.$title_text.html(options.title);\n        if (options.title_id) {\n            this.$title.attr(\"id\", options.title_id);\n        }\n        _.each([this.$content, this.$body], $el => {\n            $el[options.nopadding ? \"addClass\" : \"removeClass\"](\"no-padding\");\n        });\n\n        // render title icon\n        if (options.icon) {\n            this.$title_icon\n                .removeClass()\n                .addClass(\"portlet-title-icon fa\")\n                .addClass(options.icon)\n                .show();\n        } else {\n            this.$title_icon.hide();\n        }\n\n        // make portlet collapsible\n        this.$title_text[options.collapsible ? \"addClass\" : \"removeClass\"](\"no-highlight collapsible\").off();\n        if (options.collapsible) {\n            this.$title_text.on(\"click\", () => {\n                self[self.collapsed ? \"expand\" : \"collapse\"]();\n            });\n            options.collapsed ? this.collapse() : this.expand();\n        }\n\n        // allow title editing\n        this.$title_text.prop(\"disabled\", !options.onchange_title);\n        options.onchange_title &&\n            this.$title_text.make_text_editable({\n                on_finish: function(new_title) {\n                    options.onchange_title(new_title);\n                }\n            });\n\n        // render buttons\n        if (options.buttons) {\n            this.$buttons.empty().show();\n            $.each(this.model.get(\"buttons\"), (name, item) => {\n                item.$el.prop(\"id\", name);\n                self.$buttons.append(item.$el);\n            });\n        } else {\n            this.$buttons.hide();\n        }\n\n        // render operations\n        this.$operations.empty;\n        if (options.collapsible_button) {\n            this.$operations.append(this.collapsible_button.$el);\n        }\n        if (options.operations) {\n            $.each(options.operations, (name, item) => {\n                item.$el.prop(\"id\", name);\n                self.$operations.append(item.$el);\n            });\n        }\n        return this;\n    },\n\n    /** Append new doms to body */\n    append: function($el) {\n        this.$body.append($el);\n    },\n\n    /** Remove all content */\n    empty: function() {\n        this.$body.empty();\n    },\n\n    /** Return header element */\n    header: function() {\n        return this.$header;\n    },\n\n    /** Return body element */\n    body: function() {\n        return this.$body;\n    },\n\n    /** Show portlet */\n    show: function() {\n        this.visible = true;\n        this.$el.fadeIn(\"fast\");\n    },\n\n    /** Hide portlet */\n    hide: function() {\n        this.visible = false;\n        this.$el.hide();\n    },\n\n    /** Enable a particular button */\n    enableButton: function(id) {\n        this.$buttons.find(`#${id}`).prop(\"disabled\", false);\n    },\n\n    /** Disable a particular button */\n    disableButton: function(id) {\n        this.$buttons.find(`#${id}`).prop(\"disabled\", true);\n    },\n\n    /** Hide a particular operation */\n    hideOperation: function(id) {\n        this.$operations.find(`#${id}`).hide();\n    },\n\n    /** Show a particular operation */\n    showOperation: function(id) {\n        this.$operations.find(`#${id}`).show();\n    },\n\n    /** Replaces the event callback of an existing operation */\n    setOperation: function(id, callback) {\n        this.$operations\n            .find(`#${id}`)\n            .off(\"click\")\n            .on(\"click\", callback);\n    },\n\n    /** Change title */\n    title: function(new_title) {\n        new_title && this.$title_text.html(new_title);\n        return this.$title_text.html();\n    },\n\n    /** Collapse portlet */\n    collapse: function() {\n        this.collapsed = true;\n        this.$content.height(\"0%\");\n        this.$body.hide();\n        this.collapsible_button.setIcon(\"fa-eye-slash\");\n    },\n\n    /** Expand portlet */\n    expand: function() {\n        this.collapsed = false;\n        this.$content.height(\"100%\");\n        this.$body.fadeIn(\"fast\");\n        this.collapsible_button.setIcon(\"fa-eye\");\n    },\n\n    /** Disable content access */\n    disable: function() {\n        this.$backdrop.show();\n    },\n\n    /** Enable content access */\n    enable: function() {\n        this.$backdrop.hide();\n    },\n\n    _template: function() {\n        return $(\"<div/>\")\n            .append(\n                $(\"<div/>\")\n                    .addClass(\"portlet-header\")\n                    .append($(\"<div/>\").addClass(\"portlet-operations\"))\n                    .append(\n                        $(\"<div/>\")\n                            .addClass(\"portlet-title\")\n                            .append($(\"<i/>\").addClass(\"portlet-title-icon\"))\n                            .append($(\"<span/>\").addClass(\"portlet-title-text\"))\n                    )\n            )\n            .append(\n                $(\"<div/>\")\n                    .addClass(\"portlet-content\")\n                    .append($(\"<div/>\").addClass(\"portlet-body\"))\n                    .append($(\"<div/>\").addClass(\"portlet-buttons\"))\n            )\n            .append($(\"<div/>\").addClass(\"portlet-backdrop\"));\n    }\n});\nexport default {\n    View: View\n};\n"]}